<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>EuroAsia Loyalty App</title>
<style>
body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f9f9f9; color: #333; }
header, section, footer { padding: 20px; max-width: 800px; margin: auto; }
h1, h2 { color: #006600; }
.input-group { margin: 10px 0; }
.product { display: flex; justify-content: space-between; padding: 10px; background: #fff; border: 1px solid #ccc; margin: 10px 0; }
.favorite-list, .feedback-section, .weekly-offer { padding: 10px; margin: 20px 0; }
button { background: #006600; color: #fff; border: none; padding: 8px 12px; cursor: pointer; }
button:hover { background: #004d00; }
#dateTime { font-weight: bold; margin-bottom: 10px; }
.weekly-offer { background: #e6f7e6; border: 1px solid #c6e6c6; }
</style>
</head>
<body>
<header>
<h1>EuroAsia Grocery Loyalty</h1>
<div id="dateTime"></div>
<div class="input-group">
<label for="name">Your Name:</label>
<input type="text" id="name" />
<button onClick="saveName()">Save</button>
</div>
<p id="greeting"></p>
</header>

<section>
<h2>Favorite Products</h2>
<div class="product"><span>Mustard Oil</span> <button onClick="addFavorite('Mustard Oil')">Add</button></div>
<div class="product"><span>Green Chilli</span> <button onClick="addFavorite('Green Chilli')">Add</button></div>
<div class="product"><span>Frozen Roti</span> <button onClick="addFavorite('Frozen Roti')">Add</button></div>
</section>

<section class="favorite-list">
<h2>Your Saved Favorites</h2>
<ul id="favoritesList"></ul>
</section>

<section class="weekly-offer">
<h2>Weekly Offer</h2>
<div id="weeklyOfferTitle"></div>
<div id="weeklyOfferDescription"></div>
</section>

<section class="feedback-section">
<h2>We Value Your Feedback</h2>
<textarea id="feedback" rows="4" style="width:100%"></textarea><br/>
<button onClick="submitFeedback()">Submit Feedback</button>
<div id="feedbackMessage"></div>
</section>

<footer>
<button onClick="clearData()">Clear All Data</button>
</footer>

<script>
// Weekly Offer Data (this can be updated weekly)
const weeklyOffers = [
  { title: "Buy 1 Get 1 Free on Mustard Oil", description: "Get a free bottle of Mustard Oil with every purchase of one bottle this week only!" },
  { title: "Discount on Green Chilli", description: "20% off on Green Chilli for the whole week!" },
  { title: "Frozen Roti Sale", description: "Get 2 packs of Frozen Roti for the price of 1 this week!" }
];

// Function to get the weekly offer
function getWeeklyOffer() {
  const currentWeek = new Date().getWeek();
  const offer = weeklyOffers[currentWeek % weeklyOffers.length];  // Rotates weekly
  document.getElementById("weeklyOfferTitle").textContent = offer.title;
  document.getElementById("weeklyOfferDescription").textContent = offer.description;
}

// Date function to get the current week number (used for rotating the offers)
Date.prototype.getWeek = function() {
  var date = new Date(this.getFullYear(), this.getMonth(), this.getDate());
  var dayNr = (this.getDay() + 6) % 7; // Adjusting the day to start from Sunday
  date.setDate(date.getDate() - dayNr + 3); // Set to Thursday to get correct week number
  var firstThursday = date.valueOf();
  date.setMonth(0, 1); // Set to 1st January
  var diff = date.valueOf() - firstThursday;
  var weekNumber = Math.ceil((diff / 86400000 + 1) / 7);  // 86400000 ms in a day
  return weekNumber;
};

function saveName() {
  const name = document.getElementById("name").value.trim();
  if (!name) return;
  localStorage.setItem("username", name);
  updateGreeting();
}
function updateGreeting() {
  const name = localStorage.getItem("username") || "Guest";
  const points = parseInt(localStorage.getItem("points") || "0");
  document.getElementById("greeting").textContent = `Welcome back, ${name}! You have ${points} loyalty points.`;
}
function addFavorite(product) {
  let favs = JSON.parse(localStorage.getItem("favorites") || "[]");
  if (!favs.includes(product)) {
    favs.push(product);
    localStorage.setItem("favorites", JSON.stringify(favs));
    updatePoints(5);
    displayFavorites();
  }
}
function displayFavorites() {
  const favs = JSON.parse(localStorage.getItem("favorites") || "[]");
  const list = document.getElementById("favoritesList");
  list.innerHTML = "";  
  favs.forEach(item => {
    const li = document.createElement("li");
    li.textContent = item;
    list.appendChild(li);
  });
}
function submitFeedback() {
  const feedback = document.getElementById("feedback").value.trim();
  if (!feedback) {
    alert("Please write something before submitting.");
    return;
  }
  let feedbackList = JSON.parse(localStorage.getItem("feedbackList") || "[]");
  feedbackList.push({ comment: feedback, date: new Date().toLocaleString() });
  localStorage.setItem("feedbackList", JSON.stringify(feedbackList));
  updatePoints(10);
  document.getElementById("feedback").value = ""; 
  document.getElementById("feedbackMessage").textContent = "Thank you for your feedback!";
}
function updatePoints(value) {
  let points = parseInt(localStorage.getItem("points") || "0") + value;
  localStorage.setItem("points", points);
  updateGreeting();
}
function clearData() {
  localStorage.clear();
  updateGreeting();
  displayFavorites();
  document.getElementById("name").value = ""; 
  document.getElementById("feedback").value = ""; 
  document.getElementById("feedbackMessage").textContent = ""; 
}
function showDateTime() {
  const now = new Date();
  document.getElementById("dateTime").textContent = now.toLocaleString();
}
window.onload = function() {
  updateGreeting();
  displayFavorites();
  getWeeklyOffer();  // Load the weekly offer on startup
  showDateTime();
};
setInterval(showDateTime, 1000);
</script>
</body>
</html>
